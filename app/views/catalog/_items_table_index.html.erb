<table class='table table-condensed table-striped table-hover'>
  <thead>
    <tr class="holdings-header">
      <th class="location-header">Location</th>
      <th class="callnum-header">Call Number</th>
      <th class="status-header">Status</th>
    </tr>
  </thead>
  <% document.holdings.each do |loc_b, loc_narrow_map| %>
    <% next if loc_b == 'ONLINE' %>
    <tr class='loc-broad-group <%= loc_b %>loc-broad-banner'>
      <th colspan="3" style='background-color: #ddd;'>
        <%= map_argon_code(document.record_owner, 'loc_b', loc_b) %>
      </th>
    </tr>
  <% loc_narrow_map.each do |loc_n, item_data|  %>
    <% has_summary =!item_data.fetch('summary', '').blank? %>
      <% if has_summary %>
      <tr class='location-narrow-group'>
        <th style="width: 20%; padding-left: .5em;">
         <%= map_argon_code(document.record_owner, 'loc_n', loc_n) if loc_n %>
        </th>
        <th style="width: 30%;">
          <%= item_data['call_no'] %>
        </th>
        <th class='summary-holdings' style='width: 50%;'>
          <%= item_data.fetch('summary', '') %>
          <span class="item-details-link">
            <%= link_to "Details", controller: "catalog", action: 'show', id: document.id, anchor: "item-container-#{loc_b}-#{loc_n}" %>
          </span>
        </th>
      </tr>
      <% end %>
    
    <% unless has_summary %>
      <tbody class='item-group-display' id="<%= "item-container-#{loc_b}-#{loc_n}" %>">
        <% item_data['items'].each do |item| %>
        <tr class="item <%= loc_n %> <%= loc_b %>">
          <td style='width: 20%;'><%= map_argon_code(document.record_owner, 'loc_n', loc_n) if loc_n %></td>
          <td style='width: 30%;'><%= item['call_no'] %></td>
          <td style='width: 50%;'><%= item['status'] %></td>
        </tr>
      <% end %>
    </tbody>
    <% end %>
  <% end %>
<% end %>
</table>
